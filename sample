SELECT DISTINCT ar.*
FROM tbl_RPT_Admin_Report ar
JOIN tbl_Function_Roles fr ON ar.ReportKey = fr.FunctionID
JOIN tbl_User_Roles ur ON fr.RoleID = ur.RoleID
WHERE (ar.SiteCode IS NULL OR ar.SiteCode = @siteCode)
AND ur.UserKey = @userKey
AND ar.IsActive = 1;
