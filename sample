var parallelOptions = new ParallelOptions { MaxDegreeOfParallelism = Environment.ProcessorCount / 2 };
Parallel.ForEach(collection, parallelOptions, item => 
{
    // Your task code here
});
